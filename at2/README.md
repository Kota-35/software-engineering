Hit & Blow ゲームアプリケーション
=====================================

## 1. 仕様の実装状況

本アプリケーションは、要求仕様で定められたすべての基本機能を実装している。正解とユーザ入力は4桁の数字（0-9、重複なし）であり、Hit（同じ位置に同じ数字）とBlow（数字は含まれるが位置が違う）の計算が正確に行われる。4Hitでゲーム終了し、10回入力しても4Hitにならない場合も終了する仕様を満たしている。

ファイル操作においては、Seikai.txtから正解を読み込み、行ごとに順番にゲームを実施する。重複する正解があってもそのまま処理する仕様を実装している。標準入力からユーザー入力を受け取り、標準出力に「入力 Hit:数 Blow:数」形式で結果を表示する。ゲーム終了時にはKekka.txtに全ゲームの履歴を出力し、ゲームごとに「ゲームm回目」を出力し、最大10回分の入力結果を記録する。Hit率とBlow率は小数点以下切り捨てで計算され、正しく出力される。

入力検証機能では、4桁、0-9の数字、重複なしの条件を満たさない入力に対して再入力を求める。不正入力は履歴に含めない仕様を実装している。


## 2. ユーザの誤った操作を許容できる例外処理

本アプリケーションは、ユーザーの誤操作に対して適切な例外処理を実装し、プログラムが異常終了することなく、明確なエラーメッセージを提供する。

入力検証において、4桁でない入力、数字以外の文字が含まれる入力、数字が重複している入力に対して、それぞれ具体的なエラーメッセージを表示し、有効な入力が得られるまで再入力を求める。無効な入力は履歴に含めず、ゲームの進行に影響を与えない。エラーメッセージは赤色で表示され、視認性が高い。

ファイル操作においては、Seikai.txtが存在しない場合や読み込みエラーが発生した場合、IOExceptionをキャッチし、ユーザーフレンドリーなエラーメッセージを表示してプログラムを終了する。Kekka.txtへの書き込みに失敗した場合も同様に、エラーメッセージを表示する。標準入力の終了（EOF）が検出された場合も、適切な例外処理を行い、プログラムが予期せず終了することを防ぐ。

これらの例外処理により、ユーザーは誤操作を行ってもプログラムが停止することなく、問題点を理解して正しい操作に修正できる。


## 3. ユーザが使いやすくなるような配慮（

本アプリケーションは、CUIでありながら直感的で使いやすいインターフェースを提供するため、複数の工夫を施している。

視覚的な情報提供として、カラー出力を採用している。Hit数は緑色、Blow数は黄色で表示され、結果が一目で把握できる。エラーメッセージは赤色で表示され、問題点が明確に伝わる。情報メッセージはシアン色で表示され、重要な情報が区別しやすい。

各入力時にプロンプトを表示し、「[N回目] 4桁の数字を入力: 」という形式で、現在の試行回数と入力形式を明確に示す。プロンプトは青色・太字で表示され、入力待ち状態であることが視覚的に分かる。

進捗インジケーターとして、各試行前に「[残り試行回数: N/10]」を表示し、ユーザーが残りの試行回数を常に把握できるようにしている。これにより、時間配分を考慮した戦略的な入力が可能になる。

ゲーム終了時には、クリア/未クリアの判定、クリアに要した試行回数、Hit率・Blow率をサマリーとして表示する。クリア時は緑色のチェックマーク付きメッセージ、未クリア時は黄色の警告メッセージで表示され、結果が視覚的に分かりやすい。

全ゲーム終了時には、総ゲーム数、クリア数・クリア率、平均試行回数、最短クリア回数、最長クリア回数などの統計情報を表示する。これにより、ユーザーは自分のパフォーマンスを把握し、改善点を見つけることができる。

これらの配慮により、ユーザーは迷うことなく操作でき、ゲームの進行状況や結果を容易に理解できる。



## 4. ソースコードの読みやすさ

本アプリケーションのソースコードは、クラス構造から役割分担が明確に読み取れるように設計している

クラスの役割が明確に分離されるようにディレクトリ設計にこだわった。`domain`パッケージには、ビジネスロジックの中核となる値オブジェクト（Answer、Guess、GameResult、GameHistory）が配置されている。これらのクラスは不変オブジェクトとして設計され、データの整合性が保証されるようにしている

`service`パッケージには、再利用可能なビジネスロジック（InputValidator、HitBlowCalculator、GameStatistics）が配置されている。これらのクラスは特定のドメインに依存せず、独立してテスト可能である。

`infrastructure`パッケージには、外部リソースとのやり取りを担当するクラス（SeikaiReader、ResultWriter）が配置されている。ファイル操作の詳細がこの層に封じ込められており、将来的にデータソースを変更する場合も影響範囲が限定的である。

`util`パッケージには、共通のユーティリティ機能（ConsoleColors）が配置されている。アプリケーション層の`GameManager`は、これらのクラスを組み合わせてゲーム全体の制御フローを管理する。

ソースコードではフィールドにはクラスの責務に必要なもののみが定義され、不必要な公開は避けけるように注意している。メソッド名はその機能を明確に表し、何を行うかが一目で分かるようにしている。

例えば、`InputValidator`クラスは入力検証のみを担当し、`isValid()`メソッドで検証を行い、`getErrorMessage()`メソッドで適切なエラーメッセージを返す。`HitBlowCalculator`クラスはHitとBlowの計算のみを担当し、`calculate()`メソッドで結果を返す。


## 5. 仕様外でも魅力的な機能やソースコード的特徴

本アプリケーションは、要求仕様に加えて以下の独自機能と設計上の工夫を実装している。

### 統計情報の自動計算機能

GameStatisticsクラスを新たに作成し、全ゲームの統計情報（平均試行回数、最短クリア回数、最長クリア回数、クリア率）を自動計算する機能を実装した。この機能により、ユーザーは自分のパフォーマンスを把握でき、ゲームの楽しさが向上する。

統計情報の計算ロジックは独立したクラスに分離されているため、計算方法を変更する場合も影響範囲が限定的である。また、将来的に新しい統計情報（例: 各数字の出現頻度、Hit/Blowの傾向分析）を追加する場合も、このクラスを拡張するだけで実現できる。

### カラー出力による視認性の向上

ConsoleColorsユーティリティクラスを作成し、ANSIエスケープコードを使用したカラー出力を実装した。Hit数は緑色、Blow数は黄色、エラーメッセージは赤色で表示され、情報が視覚的に区別しやすくなる。

この機能は、CUIアプリケーションでありながら視認性を高め、ユーザー体験を向上させる。カラーコードの管理はConsoleColorsクラスに集約されているため、将来的に色の変更や新しい色の追加も容易である。

### 進捗インジケーターとサマリー表示

各試行前に残り試行回数を表示し、ゲーム終了時にサマリーを表示する機能を実装した。これにより、ユーザーは常にゲームの進行状況を把握でき、戦略的な入力が可能になる。

ゲーム終了時のサマリー表示は、GameHistoryクラスに`isCleared()`と`getClearAttempts()`メソッドを追加することで実現している。これらのメソッドにより、ゲームの結果を判定し、クリアに要した試行回数を取得できる。この設計により、サマリー表示のロジックがドメインモデルに集約され、保守性が向上している。

### 拡張しやすい設計

各クラスの責務が明確に分離されているため、新しい機能を追加する場合も既存コードへの影響が少ない。例えば、難易度設定機能を追加する場合、新しい設定クラスを作成し、GameManagerから参照するだけでよい。入力検証ルールを変更する場合も、InputValidatorクラスだけを修正すればよい。

また、インターフェースを使用していないが、各クラスの責務が明確であるため、将来的にインターフェースを導入する場合も、各クラスの実装を変更するだけでよく、影響範囲が限定的である。


